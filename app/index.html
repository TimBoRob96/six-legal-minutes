<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Six Legal Minutes</title>
  <link rel="icon" type="image/png" href="media/logo.PNG" />
  <style>
    :root {
      --bg-a: #e8efe9;
      --bg-b: #d6e2d8;
      --ink: #18261f;
      --muted: #4b5e53;
      --card: #fffffd;
      --line: #b9cabd;
      --line-strong: #8ea895;
      --accent: #1f5f3f;
      --accent-dark: #17472f;
    }

    * {
      box-sizing: border-box;
    }

    html {
      width: 100%;
      max-width: 100%;
      overflow-x: hidden;
    }

    body {
      margin: 0;
      width: 100%;
      max-width: 100%;
      min-height: 100vh;
      display: grid;
      place-items: center;
      font-family: "Times New Roman", Times, serif;
      background: linear-gradient(145deg, var(--bg-a), var(--bg-b));
      color: var(--ink);
      padding: 1rem 0.75rem;
      overflow-x: hidden;
    }

    .card {
      width: min(680px, calc(100vw - 1.5rem));
      max-width: 100%;
      background: var(--card);
      border: 1px solid var(--line-strong);
      border-radius: 6px;
      padding: 1.4rem;
      box-shadow: 0 8px 22px rgba(12, 30, 19, 0.14);
      position: relative;
      overflow-x: clip;
    }

    .card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 8px;
      background: linear-gradient(90deg, var(--accent-dark), var(--accent));
      border-radius: 6px 6px 0 0;
    }

    h1 {
      margin: 0;
      font-size: clamp(1.4rem, 2.1vw, 1.95rem);
      letter-spacing: 0.02em;
      text-transform: uppercase;
    }

    p {
      margin: 0.4rem 0 1.1rem;
      color: var(--muted);
      font-size: 1rem;
    }

    .heading {
      border-bottom: 1px solid var(--line);
      border-top: 1px solid var(--line);
      padding: 0.9rem 0 0.85rem;
      margin-bottom: 1.1rem;
      text-align: center;
      position: relative;
      background: linear-gradient(180deg, #fcfffc, #f8fdf9);
    }

    .brand {
      display: block;
      margin-bottom: 0.55rem;
    }

    .brand-logo {
      width: min(320px, 78vw);
      height: min(320px, 78vw);
      border-radius: 0;
      object-fit: cover;
      border: 0;
      background: transparent;
      padding: 0;
    }

    .heading small {
      display: block;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--accent-dark);
      font-size: 0.78rem;
      margin: 0 auto 0.2rem;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 0.8rem;
      margin-bottom: 1rem;
      min-width: 0;
    }

    .grid > * {
      min-width: 0;
    }

    label {
      display: grid;
      gap: 0.3rem;
      min-width: 0;
      overflow-x: clip;
      font-weight: 700;
      font-size: 0.9rem;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: #2a3e33;
    }

    input[type="time"] {
      width: 100%;
      max-width: 100%;
      min-width: 0;
      display: block;
      appearance: none;
      -webkit-appearance: none;
      border: 1px solid var(--line-strong);
      border-radius: 4px;
      padding: 0.6rem 0.7rem;
      font: inherit;
      font-size: 1.02rem;
      color: var(--ink);
      background: #f8fbf8;
    }

    input[type="time"]::-webkit-datetime-edit,
    input[type="time"]::-webkit-datetime-edit-fields-wrapper,
    input[type="time"]::-webkit-date-and-time-value {
      max-width: 100%;
      min-width: 0;
    }

    button {
      border: 1px solid #133523;
      border-radius: 4px;
      padding: 0.62rem 1.05rem;
      font: inherit;
      font-weight: 700;
      font-size: 0.95rem;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: #ffffff;
      background: linear-gradient(180deg, var(--accent), var(--accent-dark));
      cursor: pointer;
      margin-bottom: 1rem;
      transition: filter 120ms ease;
    }

    button:hover {
      filter: brightness(1.04);
    }

    .results-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 0.6rem;
      min-width: 0;
    }

    .result {
      background: #f7fbf8;
      border: 1px solid var(--line);
      border-radius: 4px;
      padding: 0.72rem;
    }

    .label {
      color: var(--muted);
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.2rem;
      display: block;
    }

    .value {
      font-size: 1.1rem;
      font-weight: 700;
      letter-spacing: 0.02em;
    }

    .error {
      margin-top: 0.8rem;
      color: #9f2e2e;
      font-weight: 600;
      min-height: 1.2em;
    }

    .result-stack {
      margin-top: 1rem;
      display: grid;
      gap: 0.7rem;
    }

    .calc-card {
      border: 1px solid var(--line-strong);
      background: #fcfffc;
      border-radius: 4px;
      padding: 0.8rem;
      animation: reveal 140ms ease-out;
      min-width: 0;
      overflow-x: clip;
    }

    .calc-card-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.6rem;
    }

    .calc-title {
      margin: 0;
      font-size: 0.92rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: #2a3e33;
    }

    .close-btn {
      margin: 0;
      border: 1px solid var(--line-strong);
      background: #ffffff;
      color: #244133;
      border-radius: 4px;
      padding: 0.2rem 0.45rem;
      line-height: 1;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
    }

    .card-note {
      margin-top: 0.5rem;
      color: var(--accent-dark);
      font-size: 0.88rem;
    }

    .empty-state {
      color: var(--muted);
      font-size: 0.92rem;
      padding: 0.4rem 0.1rem;
    }

    .maker-mark {
      margin-top: 1rem;
      border-top: 1px solid var(--line);
      padding-top: 0.7rem;
      font-size: 0.86rem;
      color: var(--muted);
      text-align: right;
    }

    .maker-mark a {
      color: var(--accent-dark);
      text-decoration: none;
      border-bottom: 1px solid transparent;
    }

    .maker-mark a:hover {
      border-bottom-color: var(--accent-dark);
    }

    @keyframes reveal {
      from {
        opacity: 0;
        transform: translateY(4px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @media (max-width: 640px) {
      .card {
        padding: 1rem;
      }

      .grid,
      .results-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <main class="card">
    <div class="heading">
      <div class="brand">
        <img class="brand-logo" src="media/logo.PNG" alt="Six Legal Minutes logo" />
      </div>
      <small>Legal Timekeeping Utility</small>
      <p>Enter attendance start and finish times to produce billable rounded values.</p>
    </div>

    <div class="grid">
      <label for="startTime">
        Start time
        <input id="startTime" type="time" required />
      </label>
      <label for="endTime">
        End time
        <input id="endTime" type="time" required />
      </label>
    </div>

    <button id="calcBtn" type="button">Calculate</button>

    <div class="error" id="error"></div>
    <section id="resultStack" class="result-stack" aria-live="polite">
      <div class="empty-state" id="emptyState">No calculations yet.</div>
    </section>

    <footer class="maker-mark">
      Made by Tim Roberts:
      <a href="https://timroberts.site" target="_blank" rel="noopener noreferrer">timroberts.site</a>
    </footer>
  </main>

  <script>
    function parseTimeToMinutes(timeText) {
      const [h, m] = timeText.split(":").map(Number);
      return h * 60 + m;
    }

    function roundDown6(minutes) {
      return Math.floor(minutes / 6) * 6;
    }

    function roundUp6(minutes) {
      return Math.ceil(minutes / 6) * 6;
    }

    function formatMinutesAsHHMM(totalMinutes) {
      const normalized = ((totalMinutes % (24 * 60)) + (24 * 60)) % (24 * 60);
      const h = Math.floor(normalized / 60);
      const m = normalized % 60;
      return `${String(h).padStart(2, "0")}:${String(m).padStart(2, "0")}`;
    }

    function formatDuration(minutes) {
      const h = Math.floor(minutes / 60);
      const m = minutes % 60;
      return `${String(h).padStart(2, "0")}:${String(m).padStart(2, "0")}`;
    }

    function buildResultCard(data) {
      const card = document.createElement("article");
      card.className = "calc-card";

      const overnightLine = data.overnight
        ? `<div class="card-note">End time is past midnight; calculated as overnight.</div>`
        : "";

      card.innerHTML = `
        <div class="calc-card-head">
          <h2 class="calc-title">Calculation</h2>
          <button class="close-btn" type="button" aria-label="Close result">x</button>
        </div>
        <div class="results-grid">
          <div class="result">
            <span class="label">Entered start</span>
            <div class="value">${data.enteredStart}</div>
          </div>
          <div class="result">
            <span class="label">Entered end</span>
            <div class="value">${data.enteredEnd}</div>
          </div>
          <div class="result">
            <span class="label">Rounded start</span>
            <div class="value">${data.roundedStart}</div>
          </div>
          <div class="result">
            <span class="label">Rounded end</span>
            <div class="value">${data.roundedEnd}</div>
          </div>
          <div class="result">
            <span class="label">Total duration</span>
            <div class="value">${data.duration}</div>
          </div>
          <div class="result">
            <span class="label">Total minutes</span>
            <div class="value">${data.minutes}</div>
          </div>
        </div>
        ${overnightLine}
      `;

      card.querySelector(".close-btn").addEventListener("click", () => {
        card.remove();
        const stack = document.getElementById("resultStack");
        updateCardTitles();
        if (!stack.querySelector(".calc-card")) {
          document.getElementById("emptyState").hidden = false;
        }
      });

      return card;
    }

    function updateCardTitles() {
      const cards = document.querySelectorAll("#resultStack .calc-card");
      cards.forEach((card, index) => {
        const title = card.querySelector(".calc-title");
        title.textContent = index === 0 ? "Current Record" : "Previous Record";
      });
    }

    function calculate() {
      const startText = document.getElementById("startTime").value;
      const endText = document.getElementById("endTime").value;
      const errorEl = document.getElementById("error");
      const resultStack = document.getElementById("resultStack");
      const emptyState = document.getElementById("emptyState");

      errorEl.textContent = "";

      if (!startText || !endText) {
        errorEl.textContent = "Please enter both start and end times.";
        return;
      }

      const startRaw = parseTimeToMinutes(startText);
      const endRaw = parseTimeToMinutes(endText);
      const overnight = endRaw < startRaw;
      const endAdjusted = overnight ? endRaw + (24 * 60) : endRaw;

      const roundedStart = roundDown6(startRaw);
      const roundedEnd = roundUp6(endAdjusted);
      const total = roundedEnd - roundedStart;
      const card = buildResultCard({
        enteredStart: startText,
        enteredEnd: endText,
        roundedStart: formatMinutesAsHHMM(roundedStart),
        roundedEnd: overnight
          ? `${formatMinutesAsHHMM(roundedEnd)} (next day)`
          : formatMinutesAsHHMM(roundedEnd),
        duration: formatDuration(total),
        minutes: String(total),
        overnight
      });

      emptyState.hidden = true;
      resultStack.prepend(card);

      const cards = resultStack.querySelectorAll(".calc-card");
      if (cards.length > 2) {
        cards[cards.length - 1].remove();
      }
      updateCardTitles();
    }

    document.getElementById("calcBtn").addEventListener("click", calculate);
  </script>
</body>
</html>
